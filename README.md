# RTOSHomeSensorSystem

This project runs on an esp32 microcontroller with the FreeRTOS operating system. The system includes four main sensors: a particle sensor, light sensor, temperature/humidity sensor and gas (CO) sensor. These sensors each run on their own dedicated FreeRTOS task and collect data periodically. This data is then placed into a shared FreeRTOS FIFO queue as key:value pairs that denote the sensor and its data. A "manager" task periodically dequeues values from the shared queue and computes the exponential weighted moving average of the value for that sensor before storing the value in a shared variable called a "signature". A "communication" task periodically reads these variables and transmits the average sensory data to an MQTT server via Wi-Fi. A "command" task periodically reads the signature and determines the sstate of the environment based on the sensory data. This command task then turns on actuation equipment (represented by LEDs in this project) such as an air-conditioner or furnace depending on the state of the surroundings. 

An LCD display loops through the various sensory data and displays them, as well as the time and date which is periodically fetched from an SNTP server vie Wi-Fi. All devices (sensors, actuation equipment, LCD) are accessed through uniform, low-level device functions such as dopen(), dread(), dwrite(). The devices are assigned a file descriptor when dopen() is called on them, which is then placed into a device table that contains function pointers to their individual device functions. When the system is plugged into a terminal via a USB connection, a small shell is available to the user when they type "log on". This shell allows users to create environment variables and alter system configurations such as task periods and Wi-Fi credentials (using "set" command). 

More information in the report document.
